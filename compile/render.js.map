{
"version":3,
"file":"compile/render.js",
"lineCount":159,
"mappings":"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",
"sources":["src/util.js","src/lib/index.js","src/index.js","src/depack.js"],
"sourcesContent":["// DOM properties that should NOT have \"px\" added when numeric\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i\n\nexport let encodeEntities = s => `${s}`\n  .replace(/&/g, '&amp;')\n  .replace(/</g, '&lt;')\n  .replace(/>/g, '&gt;')\n  .replace(/\"/g, '&quot;')\n\nexport let indent = (s, char) => `${s}`.replace(/(\\n+)/g, '$1' + (char || '\\t'))\n\nexport let isLargeString = (s, length = 40, ignoreLines = false) => (`${s}`.length>length || (!ignoreLines && `${s}`.indexOf('\\n')!=-1) || `${s}`.indexOf('<')!==-1)\n\nconst JS_TO_CSS = {}\n\n/**\n * Convert an Object style to a CSSText string.\n * @param {!Object} s\n */\nexport function styleObjToCss(s) {\n  let str = ''\n  for (let prop in s) {\n    let val = s[prop]\n    if (val!=null) {\n      if (str) str += ' '\n      // str += jsToCss(prop);\n      str += JS_TO_CSS[prop] || (JS_TO_CSS[prop] = prop.replace(/([A-Z])/g,'-$1').toLowerCase())\n      str += ': '\n      str += val\n      if (typeof val=='number' && IS_NON_DIMENSIONAL.test(prop)===false) {\n        str += 'px'\n      }\n      str += ';'\n    }\n  }\n  return str || undefined\n}\n\n/**\n * Reconstruct Component-style `props` from a VNode.\n * Ensures default/fallback values from `defaultProps`:\n * Own-properties of `defaultProps` not present in `vnode.attributes` are added.\n * @param {!preact.VNode} vnode The VNode to get props for\n */\nexport function getNodeProps(vnode) {\n  const props = {\n    ...vnode.attributes, children: vnode.children,\n  }\n\n  let defaultProps = vnode.nodeName.defaultProps\n  if (defaultProps!==undefined) {\n    for (let i in defaultProps) {\n      if (props[i]===undefined) {\n        props[i] = defaultProps[i]\n      }\n    }\n  }\n\n  return props\n}\n\n/**\n * @suppress {nonStandardJsDocs}\n * @typedef {import('..').VNode} preact.VNode\n */","import { encodeEntities, styleObjToCss } from '../util'\n\n/**\n * Maps attributes to `name=\"value\"` strings, and returns html if dangerouslySetInnerHTML is given.\n * @param {!Object<string, ?>} attributes\n * @param {Object} [props]\n * @param {boolean} [props.allAttributes=false]\n * @param {boolean} [props.xml=false]\n * @param {boolean} [props.isSvgMode=false]\n * @param {boolean} [props.sort=false]\n */\nexport const mapAttributes = (attributes, {\n  allAttributes, xml, isSvgMode, sort,\n} = {}) => {\n  let html\n  const attrs = Object.keys(attributes)\n  if (sort) attrs.sort()\n  const a = attrs.map((name) => {\n    let v = attributes[name]\n    if (name == 'children') return\n    if (name.match(/[\\s\\n\\\\/='\"\\0<>]/)) return\n    if (!allAttributes && ['key', 'ref'].includes(name)) return\n    if (name == 'className') {\n      if (attributes.class) return // class takes precedence\n      name = 'class'\n    } else if (name == 'htmlFor') {\n      if (attributes.for) return // class takes precedence\n      name = 'for'\n    } else if (name == 'srcSet') {\n      if (attributes.srcset) return // srcset takes precedence\n      name = 'srcset'\n    }\n    if (isSvgMode && name.match(/^xlink:?./)) {\n      name = name.toLowerCase().replace(/^xlink:?/, 'xlink:')\n    }\n    if (name == 'style' && v && typeof v == 'object') {\n      v = styleObjToCss(v)\n    }\n    if (name == 'dangerouslySetInnerHTML') {\n      html = v && v.__html // side-effect\n    } else if ((v || v===0 || v==='') && typeof v!='function') {\n      if (v===true || v==='') {\n        v = name\n        // in non-xml mode, allow boolean attributes\n        if (!xml) return name\n      }\n      return `${name}=\"${encodeEntities(v)}\"`\n    }\n  }).filter(Boolean)\n  return { mappedAttributes: a, html }\n}\n","import { encodeEntities, indent, isLargeString, getNodeProps } from './util'\nimport { mapAttributes } from './lib'\n\n// components without names, kept as a hash for later comparison to return consistent UnnamedComponentXX names.\nconst UNNAMED = []\n\nconst VOID_ELEMENTS = /^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/\n\n/** Only render elements, leaving Components inline as `<ComponentName ... />`.\n * This method is just a convenience alias for `render(vnode, context, { shallow:true })`\n * @param {preact.VNode} vnode JSX VNode to render.\n * @param {!Object} [context]  Optionally pass an initial context object through the render path.\n */\nconst shallowRender = (vnode, context) => renderToString(vnode, { shallow: true }, context)\n\n// const prettyAttributeHook = (name, value, context, opts) => {\n//   let indentChar = typeof opts.pretty=='string' ? opts.pretty : '  '\n//   return `\\n${indentChar}${name}=\"${encodeEntities(value)}\"`\n// }\n\n/**\n * Render Preact JSX Components to an HTML string.\n * @param {preact.VNode} vnode JSX VNode to render.\n * @param {!_depack.RenderConfig} [config] Rendering options.\n */\nconst render = (vnode, config = {}, context = {}) => {\n  const { addDoctype, pretty } = config\n  const res = renderToString(vnode, config, context)\n  if (addDoctype) return `<!doctype html>${pretty ? '\\n': ''}${res}`\n  return res\n}\n\n/** Render Preact JSX + Components to an HTML string.\n * @param {preact.VNode|boolean|number|string|undefined} vnode\n * @param {!_depack.RenderConfig} [opts]\n * @param {!Object} [context]\n * @param {boolean} [inner]\n * @param {boolean} [isSvgMode]\n */\nfunction renderToString(\n  vnode, opts = {}, context = {}, inner = false, isSvgMode = false\n) {\n  if (vnode==null || typeof vnode=='boolean') {\n    return ''\n  }\n\n  const {\n    pretty = false,\n    shallow = false,\n    renderRootComponent = false,\n    shallowHighOrder = false,\n    sortAttributes,\n    allAttributes,\n    xml,\n    lineLength = 40,\n    closeVoidTags = false,\n  } = opts\n\n  let { nodeName, attributes = {} } = vnode\n\n  const noPretty = ['textarea', 'pre'].includes(nodeName)\n\n  const indentChar = typeof pretty == 'string' ? pretty : '  '\n\n  // #text nodes\n  if (typeof vnode!='object' && !nodeName) {\n    return encodeEntities(vnode)\n  }\n\n  // components\n  if (typeof nodeName=='function') {\n    // nodeName = /** @type {!Function} */ (nodeName)\n    if (shallow && (inner || !renderRootComponent)) {\n      nodeName = getComponentName(nodeName)\n    }\n    else {\n      let props = getNodeProps(/** @type {!preact.VNode} */ (vnode)),\n        rendered\n\n      if (!nodeName.prototype || typeof nodeName.prototype.render!='function') {\n        // stateless functional components\n        rendered = nodeName(props, context)\n      }\n      else {\n        // class-based components\n        let c = /** @type {!preact.Component} */ (new nodeName(props, context))\n        // turn off stateful re-rendering:\n        c._disable = c.__x = true\n        c.props = props\n        c.context = context\n        if (nodeName.getDerivedStateFromProps) c.state = {\n          ...c.state,\n          ...nodeName.getDerivedStateFromProps(c.props, c.state),\n        }\n        else if (c.componentWillMount) c.componentWillMount()\n        rendered = c.render(c.props, c.state, c.context)\n\n        if (c.getChildContext) {\n          context = { ...context, ...c.getChildContext() }\n        }\n      }\n\n      return renderToString(rendered, opts, context, shallowHighOrder)\n    }\n  }\n\n  // render JSX to HTML\n  let s = '', html\n\n  let mappedAttributes\n  ;({ mappedAttributes, html } = mapAttributes(/** @type {!Object} */ (attributes), {\n    allAttributes, xml, isSvgMode, sort: sortAttributes,\n  }))\n\n  // account for >1 multiline attribute\n  if (pretty) {\n    const nl = `<${nodeName}`\n    let cl = nl.length\n    s = mappedAttributes.reduce((acc, current) => {\n      const newLength = cl + 1 + current.length\n      if (newLength > lineLength) {\n        cl = indentChar.length\n        return `${acc}\\n${indentChar}${current}`\n      }\n      cl = newLength\n      return `${acc} ${current}`\n    }, '')\n  } else {\n    s = mappedAttributes.length ? ' ' + mappedAttributes.join(' ') : ''\n  }\n\n  s = `<${nodeName}${s}>`\n  if (`${nodeName}`.match(/[\\s\\n\\\\/='\"\\0<>]/)) throw s\n\n  let isVoid = `${nodeName}`.match(VOID_ELEMENTS)\n  if (closeVoidTags) {\n    if (isVoid) s = s.replace(/>$/, ' />')\n  }\n\n  let pieces = []\n  if (html) {\n    // if multiline, indent.\n    if (pretty && (isLargeString(html) || html.length + getLastLineLength(s) > lineLength)) {\n      html = '\\n' + indentChar + indent(html, indentChar)\n    }\n    s += html\n  }\n  else if (vnode.children) {\n    let hasLarge = pretty && ~s.indexOf('\\n')\n    pieces = vnode.children.map((child) => {\n      if (child==null || child===false) return\n      const childSvgMode = nodeName == 'svg' ? true : nodeName == 'foreignObject' ? false : isSvgMode\n      const ret = renderToString(child, opts, context, true, childSvgMode)\n      if (!ret) return\n      if (pretty && ret.length + getLastLineLength(s) > lineLength)\n        hasLarge = true\n      return ret\n    }).filter(Boolean)\n\n    if (pretty && hasLarge && !noPretty) {\n      for (let i=pieces.length; i--;) {\n        pieces[i] = '\\n' + indentChar + indent(pieces[i], indentChar)\n      }\n    }\n  }\n\n  if (pieces.length) {\n    s += pieces.join('')\n  }\n  else if (xml) {\n    return s.substring(0, s.length-1) + ' />'\n  }\n\n  if (!isVoid) {\n    if (!noPretty && pretty && ~s.indexOf('\\n')) s += '\\n'\n    s += `</${nodeName}>`\n  }\n\n  return s\n}\n\n/**\n * @param {!Function} component\n */\nfunction getComponentName(component) {\n  return component.displayName || component!==Function && component.name || getFallbackComponentName(component)\n}\n\n/**\n * @param {!Function} component\n */\nfunction getFallbackComponentName(component) {\n  /** @type {string} */\n  const str = Function.prototype.toString.call(component)\n\n  let name = (str.match(/^\\s*function\\s+([^( ]+)/) || '')[1]\n  if (!name) {\n    // search for an existing indexed name for the given component:\n    let index = -1\n    for (let i=UNNAMED.length; i--; ) {\n      if (UNNAMED[i]===component) {\n        index = i\n        break\n      }\n    }\n    // not found, create a new indexed name:\n    if (index<0) {\n      index = UNNAMED.push(component) - 1\n    }\n    name = `UnnamedComponent${index}`\n  }\n  return name\n}\n\nexport default render\n\nexport { shallowRender }\n\nconst getLastLineLength = (s) => {\n  const st = s.split('\\n')\n  const lastLine = st[st.length - 1]\n  return lastLine.length\n}\n\n/**\n * @suppress {nonStandardJsDocs}\n * @typedef {import('..').RenderConfig} _depack.RenderConfig\n */\n/**\n * @suppress {nonStandardJsDocs}\n * @typedef {import('..').VNode} preact.VNode\n */\n/**\n * @suppress {nonStandardJsDocs}\n * @typedef {import('..').Component} preact.Component\n */","import '../types/externs'\nimport '@externs/preact/types/externs'\n\nimport render from './'\n\nmodule.exports = render"],
"names":["IS_NON_DIMENSIONAL","encodeEntities","s","replace","isLargeString","length","indexOf","JS_TO_CSS","getNodeProps","vnode","props","attributes","children","defaultProps","nodeName","undefined","i","mapAttributes","allAttributes","xml","isSvgMode","sort","html","attrs","Object","keys","mappedAttributes","map","name","v","match","includes","class","for","srcset","toLowerCase","str","prop","val","test","__html","filter","a","Boolean","UNNAMED","VOID_ELEMENTS","renderToString","opts","context","inner","pretty","shallow","renderRootComponent","shallowHighOrder","sortAttributes","lineLength","closeVoidTags","noPretty","indentChar","prototype","render","c","_disable","__x","getDerivedStateFromProps","state","componentWillMount","rendered","getChildContext","displayName","Function","getFallbackComponentName","cl","nl","reduce","acc","current","newLength","join","isVoid","pieces","getLastLineLength","hasLarge","child","ret","childSvgMode","substring","component","toString","call","index","push","st","split","lastLine","module","exports","config","addDoctype","res"]
}
